# 쿠키와 세션

> 출처 [블로그](https://interconnection.tistory.com/74)을 보고 정리한 내용입니다.

HTTP 프로토콜의 특성인 connectionless, stateless 때문에 서버는 클라이언트가 누구인지 확인하기 위해 쿠키와 세션을 사용한다.

## 쿠키

-   쿠키는 클라이언트(브라우저) 로컬에 저장되는 키와 값이 들어있는 작은 데이터 파일이다.
-   사용자 인증이 유효한 시간을 명시할 수 있으며, 유효 시간이 정해지면 브라우저가 종료되어도 인증이 유지된다.
-   사용자가 따로 요청하지 않아도 브라우저가 request시에 request header를 넣어서 자동으로 서버에 전송한다.

### 구성요소

-   이름 : 각각의 쿠키를 구별하는 데 사용되는 이름
-   값 : 쿠키의 이름과 관련된 값
-   유효시간 : 쿠키의 유지시간
-   도메인 : 쿠키를 전송할 도메인
-   경로 : 쿠키를 전송할 요청 경로

### 동작 방식

1. 클라이언트가 페이지를 요청
2. 서버에서 쿠키를 생성
3. HTTP 헤더에 쿠키를 포함시켜 응답
4. 브라우저가 종료되어도 쿠키 만료 기간이 있으면 클라이언트에서 보관
5. 같은 요청을 할 경우 HTTP 헤더에 쿠키를 담아 전달
6. 서버에서 쿠키를 읽어 이전 상태 정보를 변경 할 필요가 있을 때 쿠키를 업데이트하여 변경된 쿠키를 HTTP 헤더에 포함시켜 응답

### 사용 예시

-   로그인 시, 아이디 비밀번호를 저장하시겠습니까?
-   장바구니 기능
-   팝업 창 오늘 이 창을 더 이상 보지 않음

---

## 세션

-   세션은 쿠키를 기반으로 하지만, 사용자 정보 파일을 브라우저에 저장하는 쿠키와 달리 세션은 서버에 저장한다.
-   즉, 서버에서 클라이언트를 구분하기 위한 세션 ID를 부여해 인증상태를 유지한다.
-   사용자에 대한 정보를 서버에 두기 때문에 쿠키보다 보안에 좋지만, 사용자가 많아질수록 서버 메모리를 많이 차지한다.

### 동작 방식

1. 클라이언트가 서버에 접속 시 세션 ID를 발급 받음
2. 클라이언트는 세션 ID에 대해 쿠키를 사용해 저장하고 있음
3. 클라이언트는 서버에 요청할 때, 이 쿠키의 세션 ID를 같이 서버에 전달
4. 서버는 받은 세션 ID를 통해 세션에 있는 클라이언트 정보를 가져와 응답에 사용

### 특징

-   각 클라이언트에 고유 ID를 부여
-   보안 면에서 쿠키보다 우수
-   사용자가 많아질수록 서버 메모리를 많이 차지

---

## 쿠키와 세션의 차이

-   둘은 비슷한 역할을 하며 세션도 쿠키를 사용한다.
-   차이는 사용자의 정보가 저장되는 위치이다. 따라서 쿠키는 서버의 자원을 전혀 사용하지 않고, 세션은 서버의 자원을 사용한다.
-   보안 면에선 세션, 요청 속도는 쿠키가 더 빠르다. 세션은 서버의 처리가 필요하기 때문이다.
-   라이프 사이클 : 돌 다 만료시간을 정할 수 있고 쿠키는 브라우저를 종료해도 남아 있지만 세션은 만료시간에 관계없이 브라우저를 종료하면 사라진다.
